# 회원관리 및 운동 능력 기록 앱 서버

## 📌 팀원

- [김민지](https://github.com/enddl3224)
- [조예슬](https://github.com/eungang3)
- [육지](https://github.com/azure928)
- [김교은](https://github.com/gyoeun666)
- [오서준](https://github.com/Pi-ren)
- [이윤재](https://github.com/Yunjae53)

<br/>

## 📌 서비스 개요

회원관리 및 운동 능력 기록 앱

<br/>

## 📌 제작 기간

2022.10.04 ~ 2022.10.06 (3일)

<br/>

## 📌 요구사항 분석 및 구현

### 회원

**1. 회원 정보 등록하기**

- 회원 정보(이름, 생년월일, 키, 전화번호)를 기입하여 DB에 저장하도록 구현했습니다.
- 전화번호에 unique를 걸어 동일한 사용자가 중복등록하는 것을 방지하였습니다.

**2. 회원 목록 가져오기**

- 전체 회원 목록을 가져오면서 sql로 특정 회원 정보도 가져오도록 구현하였습니다.

**3. 특정 회원 정보 가져오기**

**4. 특정 회원 정보 수정하기**

**5. 특정 회원 삭제하기**

- 회원 데이터는 실제로 삭제되는 것이 아니고 users 테이블 deleted_at 컬럼에 현재 시간을 업데이트해 주도록 구현했습니다.
- 이름과 휴대폰 번호는 마스킹 처리되어 업데이트됩니다.

---

### 측정 기록

**1. 특정 회원의 측정 기록들(목록) 가져오기**

- 유저아이디를 이용하여 해당 유저의 측정 기록을 전부 조회합니다.
- 미가입 유저, 삭제된 유저, 측정 기록이 없는 유저는 그에 맞는 에러 메세지를 보냅니다.

**2. 특정 측정 기록 및 측정 데이터 가져오기**

- 측정 기록 아이디를 이용하여 측정 기록을 조회합니다.
- 조회한 측정 기록에 관련된 유저 정보 중 관련된 정보 또한 같이 조회하여 데이터를 활용하는데 있어 도움이 될 수 있도록 했습니다.

**3. 특정 회원에 대한 측정 기록과 측정 데이터 생성**

- (datas) record_id,type_id 복합 유니크키를 생성하여 측정데이터 타입 중복 불가 처리를 했습니다.
- 어깨 굴곡과 어깨 신전 중 하나만 들어올 경우 에러메세지를 반환합니다.
- datas -> figure 값 유효성 검사
  - types_limits 테이블을 추가한 뒤 BEFORE INSERT TRIGGER를 이용하여 INSERT 전 값 범위 제한 검사를 진행 후 조건에 맞지 않을 경우 400과 에러메세지를 반환합니다.
- 측정기록은 하나, 측정데이터는 여러개를 동시 생성할 수 있도록 프론트에서 배열로 받은 데이터를 처리할 수 있도록 하였습니다.
- 측정기록과 측정데이터는 동시 생성됩니다.

**4. 측정 기록 삭제하기**

- 측정 기록 id를 패스 파라미터로 받아 해당 기록을 삭제합니다.
- 측정 데이터 테이블(datas)은 측정 기록 테이블(records)을 record_id라는 외래키 칼럼으로 참조합니다. record_id에는 ON DELETE CASCADE 조건이 걸려있기 때문에, 측정 기록 테이블(records)의 데이터를 삭제하면 연관된 측정 데이터도 모두 자동으로 삭제됩니다.
- ON DELETE CASCADE가 걸린 경우 mysql에서 자동으로 TRANSACTION을 사용하여 처리하므로 따로 트랜잭션을 명시하지는 않았습니다.

<br/>

## 📌 DB Modeling

**[🔗 dbdiagram](https://dbdiagram.io/d/633c1ad6f0018a1c5f8e9f86)**
![DB Modeling](https://res.cloudinary.com/dxp1x1h2p/image/upload/v1665077028/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2022-10-07_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_2.16.56_nmwdwq.png)

<br>

## 📌 API DOCS

**[🔗 API DOCS](https://charmed-skirt-18c.notion.site/3-api-da65b8473dee41daacea0ae879adc958)**

<br/>

## 📌 적용 기술

- 사용언어 : Javascript
- 런타임 환경 : Node.js
- 프레임워크 : Express
- 데이터베이스 : MySQL

<br/>

## 📌 Commit Convention

- Init : 프로젝트 초기 세팅
- Add : 새로운 기능 추가
- Update : 원래도 정상적으로 동작하고 있었지만 수정, 추가, 보완 했을 때
- Fix : 올바르지 않은 동작을 고친 경우 (버그 수정)
- Chore : 빌드 업무 수정, 패키지 매니저 수정, 그 외 자잘한 수정에 대한 커밋
- Docs : 문서 작성, 수정
- Refactor : 코드 리팩토링
- Test : 테스트 코드 추가
- Style : 코드 포맷팅, 세미콜론 누락, 코드 변경이 없는 경우, linting
